<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>í•™êµ Q&A í”Œë«í¼</title>
<style>
body { font-family: Arial; background:#f4f6f8; margin:0; padding:0; }
.header { background:#2c3e50; color:white; padding:15px; text-align:center; font-size:22px; }
.menu { margin:20px; }
input, button, select { padding:5px; margin:5px 0; }
.question { padding:10px; margin:10px 0; border-radius:8px; font-weight:bold; background:#fff; }
.solved { background-color:#d4edda; color:#155724; }
.unsolved { background-color:#f8d7da; color:#721c24; }
</style>
</head>
<body>

<div class="header">í•™êµ Q&A í”Œë«í¼</div>

<!-- ë¡œê·¸ì¸ ì˜ì—­ -->
<div id="auth">
  <h3>íšŒì›ê°€ì… / ë¡œê·¸ì¸</h3>
  ì´ë©”ì¼: <input type="email" id="email"><br>
  ë¹„ë°€ë²ˆí˜¸: <input type="password" id="password"><br>
  ë‹‰ë„¤ì„: <input type="text" id="nickname"><br>
  <button onclick="signup()">íšŒì›ê°€ì…</button>
  <button onclick="login()">ë¡œê·¸ì¸</button>
</div>

<!-- ì§ˆë¬¸ ì‘ì„± ì˜ì—­ -->
<div id="questionForm" style="display:none;">
  <h3>ì§ˆë¬¸ ì‘ì„±</h3>
  ê³¼ëª©:
  <select id="subject">
    <option>ìˆ˜í•™</option>
    <option>ì˜ì–´</option>
    <option>ê³¼í•™</option>
    <option>ê¸°íƒ€</option>
  </select><br>
  ì§ˆë¬¸ ë‚´ìš©:<br>
  <textarea id="questionText" rows="3" cols="50"></textarea><br>
  <button onclick="addQuestion()">ì§ˆë¬¸ ë“±ë¡ (+10P)</button>
</div>

<!-- ì§ˆë¬¸ ëª©ë¡ -->
<div id="questionsBoard">
  <h3>ì§ˆë¬¸ ëª©ë¡</h3>
  <div id="questions"></div>
</div>

<!-- Firebase SDK -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-auth.js";
import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-firestore.js";

// Firebase ì„¤ì •
const firebaseConfig = {
  apiKey: "AIzaSyC9y33YK_3b5NMfAk6dZi2jDMIi_dDXklQ",
  authDomain: "site4school-6affe.firebaseapp.com",
  projectId: "site4school-6affe",
  storageBucket: "site4school-6affe.firebasestorage.app",
  messagingSenderId: "527337035288",
  appId: "1:527337035288:web:290da151584a31eb90d56d",
  measurementId: "G-PLB6VXX955"
};

// Firebase ì´ˆê¸°í™”
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// íšŒì›ê°€ì…
async function signup() {
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;
  const nickname = document.getElementById("nickname").value;
  try {
    const userCredential = await createUserWithEmailAndPassword(auth, email, password);
    alert("íšŒì›ê°€ì… ì™„ë£Œ! ë¡œê·¸ì¸ í›„ ì‚¬ìš©í•˜ì„¸ìš”.");
  } catch (err) {
    alert(err.message);
  }
}

// ë¡œê·¸ì¸
async function login() {
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;
  try {
    const userCredential = await signInWithEmailAndPassword(auth, email, password);
    alert("ë¡œê·¸ì¸ ì„±ê³µ!");
    document.getElementById("auth").style.display = "none";
    document.getElementById("questionForm").style.display = "block";
    loadQuestions();
  } catch (err) {
    alert(err.message);
  }
}

// ì§ˆë¬¸ ì¶”ê°€
async function addQuestion() {
  const text = document.getElementById("questionText").value;
  const subject = document.getElementById("subject").value;
  try {
    await addDoc(collection(db, "questions"), {
      subject: subject,
      text: text,
      status: "unsolved"
    });
    alert("ì§ˆë¬¸ ë“±ë¡ ì™„ë£Œ! (+10P)");
    loadQuestions();
    document.getElementById("questionText").value = "";
  } catch (err) {
    alert(err.message);
  }
}

// ì§ˆë¬¸ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
async function loadQuestions() {
  const querySnapshot = await getDocs(collection(db, "questions"));
  const container = document.getElementById("questions");
  container.innerHTML = "";
  querySnapshot.forEach((doc) => {
    const q = doc.data();
    const div = document.createElement("div");
    div.className = "question " + q.status;
    div.innerText = `ğŸ”¹ [${q.status === "solved" ? "í•´ê²°ë¨" : "ë¯¸í•´ê²°"}] ${q.subject} - ${q.text}`;
    container.appendChild(div);
  });
}
</script>

</body>
</html>